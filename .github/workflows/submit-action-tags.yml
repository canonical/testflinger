name: Auto Tag on Submit Changes

on:
  push:
    branches:
      #- main
      - CERTTF-568-submit-action-tags-workflow
    paths:
      - .github/actions/submit.yaml

jobs:
  auto-tag-submit-action:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Fetch all history for semantic versioning
          persist-credentials: false

      - name: Generate semantic version
        id: version
        uses: PaulHatch/semantic-version@v5.4.0
        with:          
          namespace: "submit"
          change_path: ".github/actions/submit/action.yaml"
          major_pattern: "breaking(submit):"
          minor_pattern: "feat(submit):"

      - name: Create and push tag
        env:
          TAG: ${{ steps.version.outputs.version_tag }}
        run: |          
          # Configure git
          #git config user.name "GitHub Actions"
          #git config user.email "actions@github.com"
          
          # Create tag
          git tag "$TAG"
          echo ::notice::"$TAG"
          git tag

          # Push tag
          #git push origin "$VERSION"
